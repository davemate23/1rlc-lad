{"filter":false,"title":"new.html.erb","tooltip":"/app/views/employees/new.html.erb","undoManager":{"mark":65,"position":65,"stack":[[{"group":"doc","deltas":[{"start":{"row":5,"column":4},"end":{"row":5,"column":37},"action":"remove","lines":["<%= form_for(@employee) do |f| %>"]},{"start":{"row":5,"column":4},"end":{"row":5,"column":70},"action":"insert","lines":["<%= form_for(@employee, html: { class: \"directUpload\" }) do |f| %>"]}]}],[{"group":"doc","deltas":[{"start":{"row":44,"column":44},"end":{"row":45,"column":0},"action":"insert","lines":["",""]},{"start":{"row":45,"column":0},"end":{"row":45,"column":6},"action":"insert","lines":["      "]}]}],[{"group":"doc","deltas":[{"start":{"row":45,"column":6},"end":{"row":46,"column":0},"action":"insert","lines":["",""]},{"start":{"row":46,"column":0},"end":{"row":46,"column":6},"action":"insert","lines":["      "]}]}],[{"group":"doc","deltas":[{"start":{"row":46,"column":6},"end":{"row":49,"column":6},"action":"insert","lines":["<div class=\"field\">","  <%= f.label :avatar_url %><br>","  <%= f.file_field :avatar_url %>","</div>"]}]}],[{"group":"doc","deltas":[{"start":{"row":45,"column":0},"end":{"row":46,"column":25},"action":"remove","lines":["      ","      <div class=\"field\">"]}]}],[{"group":"doc","deltas":[{"start":{"row":46,"column":0},"end":{"row":46,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":46,"column":2},"end":{"row":46,"column":4},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":47,"column":0},"end":{"row":47,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":47,"column":2},"end":{"row":47,"column":4},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":5},"end":{"row":48,"column":6},"action":"remove","lines":[">"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":4},"end":{"row":48,"column":5},"action":"remove","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":3},"end":{"row":48,"column":4},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":2},"end":{"row":48,"column":3},"action":"remove","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":1},"end":{"row":48,"column":2},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":0},"end":{"row":48,"column":1},"action":"remove","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":47,"column":37},"end":{"row":48,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":0},"end":{"row":4,"column":24},"action":"remove","lines":["    <%= render 'form' %>"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":40},"end":{"row":4,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":7,"column":9},"action":"insert","lines":["<script>","  $(function() {","    $('.directUpload').find(\"input:file\").each(function(i, elem) {","      var fileInput    = $(elem);","      console.log(fileInput);","    });","  });","</script>"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":0},"end":{"row":6,"column":5},"action":"remove","lines":["  $(function() {","    $('.directUpload').find(\"input:file\").each(function(i, elem) {","      var fileInput    = $(elem);","      console.log(fileInput);","    });","  });"]},{"start":{"row":1,"column":0},"end":{"row":20,"column":3},"action":"insert","lines":["$(function() {","  $('.directUpload').find(\"input:file\").each(function(i, elem) {","    var fileInput    = $(elem);","    var form         = $(fileInput.parents('form:first'));","    var submitButton = form.find('input[type=\"submit\"]');","    var progressBar  = $(\"<div class='bar'></div>\");","    var barContainer = $(\"<div class='progress'></div>\").append(progressBar);","    fileInput.after(barContainer);","    fileInput.fileupload({","      fileInput:       fileInput,","      url:             '<%= @s3_direct_post.url %>',","      type:            'POST',","      autoUpload:       true,","      formData:         <%= @s3_direct_post.fields.to_json.html_safe %>,","      paramName:        'file', // S3 does not like nested name fields i.e. name=\"user[avatar_url]\"","      dataType:         'XML',  // S3 returns XML if success_action_status is set to 201","      replaceFileInput: false","    });","  });","});"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":22,"column":0},"action":"remove","lines":["<script>","$(function() {","  $('.directUpload').find(\"input:file\").each(function(i, elem) {","    var fileInput    = $(elem);","    var form         = $(fileInput.parents('form:first'));","    var submitButton = form.find('input[type=\"submit\"]');","    var progressBar  = $(\"<div class='bar'></div>\");","    var barContainer = $(\"<div class='progress'></div>\").append(progressBar);","    fileInput.after(barContainer);","    fileInput.fileupload({","      fileInput:       fileInput,","      url:             '<%= @s3_direct_post.url %>',","      type:            'POST',","      autoUpload:       true,","      formData:         <%= @s3_direct_post.fields.to_json.html_safe %>,","      paramName:        'file', // S3 does not like nested name fields i.e. name=\"user[avatar_url]\"","      dataType:         'XML',  // S3 returns XML if success_action_status is set to 201","      replaceFileInput: false","    });","  });","});","</script>",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":51,"column":3},"action":"insert","lines":["$(function() {","  $('.directUpload').find(\"input:file\").each(function(i, elem) {","    var fileInput    = $(elem);","    var form         = $(fileInput.parents('form:first'));","    var submitButton = form.find('input[type=\"submit\"]');","    var progressBar  = $(\"<div class='bar'></div>\");","    var barContainer = $(\"<div class='progress'></div>\").append(progressBar);","    fileInput.after(barContainer);","    fileInput.fileupload({","      fileInput:       fileInput,","      url:             '<%= @s3_direct_post.url %>',","      type:            'POST',","      autoUpload:       true,","      formData:         <%= @s3_direct_post.fields.to_json.html_safe %>,","      paramName:        'file', // S3 does not like nested name fields i.e. name=\"user[avatar_url]\"","      dataType:         'XML',  // S3 returns XML if success_action_status is set to 201","      replaceFileInput: false,","      progressall: function (e, data) {","        var progress = parseInt(data.loaded / data.total * 100, 10);","        progressBar.css('width', progress + '%')","      },","      start: function (e) {","        submitButton.prop('disabled', true);","","        progressBar.","          css('background', 'green').","          css('display', 'block').","          css('width', '0%').","          text(\"Loading...\");","      },","      done: function(e, data) {","        submitButton.prop('disabled', false);","        progressBar.text(\"Uploading done\");","","        // extract key and generate URL from response","        var key   = $(data.jqXHR.responseXML).find(\"Key\").text();","        var url   = '//<%= @s3_direct_post.url.host %>/' + key;","","        // create hidden field","        var input = $(\"<input />\", { type:'hidden', name: fileInput.attr('name'), value: url })","        form.append(input);","      },","      fail: function(e, data) {","        submitButton.prop('disabled', false);","","        progressBar.","          css(\"background\", \"red\").","          text(\"Failed\");","      }","    });","  });","});"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":3},"end":{"row":52,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":0},"end":{"row":52,"column":1},"action":"insert","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":1},"end":{"row":52,"column":2},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":2},"end":{"row":52,"column":3},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":3},"end":{"row":52,"column":4},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":4},"end":{"row":52,"column":5},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":5},"end":{"row":52,"column":6},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":6},"end":{"row":52,"column":7},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":7},"end":{"row":52,"column":8},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":8},"end":{"row":52,"column":9},"action":"insert","lines":[">"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":0},"end":{"row":1,"column":1},"action":"insert","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":1},"end":{"row":1,"column":2},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":3},"end":{"row":1,"column":4},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":4},"end":{"row":1,"column":5},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":5},"end":{"row":1,"column":6},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":6},"end":{"row":1,"column":7},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":7},"end":{"row":1,"column":17},"action":"insert","lines":["></script>"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":8},"end":{"row":3,"column":0},"action":"insert","lines":["","  ",""]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":3,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":[">"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":0},"end":{"row":2,"column":2},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":0},"end":{"row":2,"column":2},"action":"insert","lines":["  "]},{"start":{"row":3,"column":0},"end":{"row":3,"column":2},"action":"insert","lines":["  "]},{"start":{"row":4,"column":0},"end":{"row":4,"column":2},"action":"insert","lines":["  "]},{"start":{"row":5,"column":0},"end":{"row":5,"column":2},"action":"insert","lines":["  "]},{"start":{"row":6,"column":0},"end":{"row":6,"column":2},"action":"insert","lines":["  "]},{"start":{"row":7,"column":0},"end":{"row":7,"column":2},"action":"insert","lines":["  "]},{"start":{"row":8,"column":0},"end":{"row":8,"column":2},"action":"insert","lines":["  "]},{"start":{"row":9,"column":0},"end":{"row":9,"column":2},"action":"insert","lines":["  "]},{"start":{"row":10,"column":0},"end":{"row":10,"column":2},"action":"insert","lines":["  "]},{"start":{"row":11,"column":0},"end":{"row":11,"column":2},"action":"insert","lines":["  "]},{"start":{"row":12,"column":0},"end":{"row":12,"column":2},"action":"insert","lines":["  "]},{"start":{"row":13,"column":0},"end":{"row":13,"column":2},"action":"insert","lines":["  "]},{"start":{"row":14,"column":0},"end":{"row":14,"column":2},"action":"insert","lines":["  "]},{"start":{"row":15,"column":0},"end":{"row":15,"column":2},"action":"insert","lines":["  "]},{"start":{"row":16,"column":0},"end":{"row":16,"column":2},"action":"insert","lines":["  "]},{"start":{"row":17,"column":0},"end":{"row":17,"column":2},"action":"insert","lines":["  "]},{"start":{"row":18,"column":0},"end":{"row":18,"column":2},"action":"insert","lines":["  "]},{"start":{"row":19,"column":0},"end":{"row":19,"column":2},"action":"insert","lines":["  "]},{"start":{"row":20,"column":0},"end":{"row":20,"column":2},"action":"insert","lines":["  "]},{"start":{"row":21,"column":0},"end":{"row":21,"column":2},"action":"insert","lines":["  "]},{"start":{"row":22,"column":0},"end":{"row":22,"column":2},"action":"insert","lines":["  "]},{"start":{"row":23,"column":0},"end":{"row":23,"column":2},"action":"insert","lines":["  "]},{"start":{"row":24,"column":0},"end":{"row":24,"column":2},"action":"insert","lines":["  "]},{"start":{"row":25,"column":0},"end":{"row":25,"column":2},"action":"insert","lines":["  "]},{"start":{"row":26,"column":0},"end":{"row":26,"column":2},"action":"insert","lines":["  "]},{"start":{"row":27,"column":0},"end":{"row":27,"column":2},"action":"insert","lines":["  "]},{"start":{"row":28,"column":0},"end":{"row":28,"column":2},"action":"insert","lines":["  "]},{"start":{"row":29,"column":0},"end":{"row":29,"column":2},"action":"insert","lines":["  "]},{"start":{"row":30,"column":0},"end":{"row":30,"column":2},"action":"insert","lines":["  "]},{"start":{"row":31,"column":0},"end":{"row":31,"column":2},"action":"insert","lines":["  "]},{"start":{"row":32,"column":0},"end":{"row":32,"column":2},"action":"insert","lines":["  "]},{"start":{"row":33,"column":0},"end":{"row":33,"column":2},"action":"insert","lines":["  "]},{"start":{"row":34,"column":0},"end":{"row":34,"column":2},"action":"insert","lines":["  "]},{"start":{"row":35,"column":0},"end":{"row":35,"column":2},"action":"insert","lines":["  "]},{"start":{"row":36,"column":0},"end":{"row":36,"column":2},"action":"insert","lines":["  "]},{"start":{"row":37,"column":0},"end":{"row":37,"column":2},"action":"insert","lines":["  "]},{"start":{"row":38,"column":0},"end":{"row":38,"column":2},"action":"insert","lines":["  "]},{"start":{"row":39,"column":0},"end":{"row":39,"column":2},"action":"insert","lines":["  "]},{"start":{"row":40,"column":0},"end":{"row":40,"column":2},"action":"insert","lines":["  "]},{"start":{"row":41,"column":0},"end":{"row":41,"column":2},"action":"insert","lines":["  "]},{"start":{"row":42,"column":0},"end":{"row":42,"column":2},"action":"insert","lines":["  "]},{"start":{"row":43,"column":0},"end":{"row":43,"column":2},"action":"insert","lines":["  "]},{"start":{"row":44,"column":0},"end":{"row":44,"column":2},"action":"insert","lines":["  "]},{"start":{"row":45,"column":0},"end":{"row":45,"column":2},"action":"insert","lines":["  "]},{"start":{"row":46,"column":0},"end":{"row":46,"column":2},"action":"insert","lines":["  "]},{"start":{"row":47,"column":0},"end":{"row":47,"column":2},"action":"insert","lines":["  "]},{"start":{"row":48,"column":0},"end":{"row":48,"column":2},"action":"insert","lines":["  "]},{"start":{"row":49,"column":0},"end":{"row":49,"column":2},"action":"insert","lines":["  "]},{"start":{"row":50,"column":0},"end":{"row":50,"column":2},"action":"insert","lines":["  "]},{"start":{"row":51,"column":0},"end":{"row":51,"column":2},"action":"insert","lines":["  "]},{"start":{"row":52,"column":0},"end":{"row":52,"column":2},"action":"insert","lines":["  "]},{"start":{"row":53,"column":0},"end":{"row":53,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":54,"column":9},"action":"remove","lines":["","<script>","  $(function() {","    $('.directUpload').find(\"input:file\").each(function(i, elem) {","      var fileInput    = $(elem);","      var form         = $(fileInput.parents('form:first'));","      var submitButton = form.find('input[type=\"submit\"]');","      var progressBar  = $(\"<div class='bar'></div>\");","      var barContainer = $(\"<div class='progress'></div>\").append(progressBar);","      fileInput.after(barContainer);","      fileInput.fileupload({","        fileInput:       fileInput,","        url:             '<%= @s3_direct_post.url %>',","        type:            'POST',","        autoUpload:       true,","        formData:         <%= @s3_direct_post.fields.to_json.html_safe %>,","        paramName:        'file', // S3 does not like nested name fields i.e. name=\"user[avatar_url]\"","        dataType:         'XML',  // S3 returns XML if success_action_status is set to 201","        replaceFileInput: false,","        progressall: function (e, data) {","          var progress = parseInt(data.loaded / data.total * 100, 10);","          progressBar.css('width', progress + '%')","        },","        start: function (e) {","          submitButton.prop('disabled', true);","  ","          progressBar.","            css('background', 'green').","            css('display', 'block').","            css('width', '0%').","            text(\"Loading...\");","        },","        done: function(e, data) {","          submitButton.prop('disabled', false);","          progressBar.text(\"Uploading done\");","  ","          // extract key and generate URL from response","          var key   = $(data.jqXHR.responseXML).find(\"Key\").text();","          var url   = '//<%= @s3_direct_post.url.host %>/' + key;","  ","          // create hidden field","          var input = $(\"<input />\", { type:'hidden', name: fileInput.attr('name'), value: url })","          form.append(input);","        },","        fail: function(e, data) {","          submitButton.prop('disabled', false);","  ","          progressBar.","            css(\"background\", \"red\").","            text(\"Failed\");","        }","      });","    });","  });","</script>"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":45,"column":28},"end":{"row":45,"column":29},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":45,"column":27},"end":{"row":45,"column":28},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":45,"column":26},"end":{"row":45,"column":27},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":45,"column":25},"end":{"row":45,"column":26},"action":"remove","lines":["_"]}]}],[{"group":"doc","deltas":[{"start":{"row":46,"column":33},"end":{"row":46,"column":34},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":46,"column":32},"end":{"row":46,"column":33},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":46,"column":31},"end":{"row":46,"column":32},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":46,"column":30},"end":{"row":46,"column":31},"action":"remove","lines":["_"]}]}]]},"ace":{"folds":[],"scrolltop":540,"scrollleft":0,"selection":{"start":{"row":46,"column":30},"end":{"row":46,"column":30},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1421434959352,"hash":"7dcc9518fd9edb598796af3c7ca719be1fc52c87"}