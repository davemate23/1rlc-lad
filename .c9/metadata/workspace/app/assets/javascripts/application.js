{"filter":false,"title":"application.js","tooltip":"/app/assets/javascripts/application.js","undoManager":{"mark":14,"position":14,"stack":[[{"group":"doc","deltas":[{"start":{"row":13,"column":22},"end":{"row":14,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":14,"column":21},"action":"insert","lines":["//= require bootstrap"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":18},"end":{"row":17,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":0},"end":{"row":17,"column":31},"action":"insert","lines":["//= require z.jquery.fileupload"]}]}],[{"group":"doc","deltas":[{"start":{"row":18,"column":0},"end":{"row":19,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":0},"end":{"row":24,"column":3},"action":"insert","lines":["$(function() {","  $('.directUpload').find(\"input:file\").each(function(i, elem) {","    var fileInput    = $(elem);","    console.log(fileInput);","  });","});"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":4},"end":{"row":22,"column":27},"action":"remove","lines":["console.log(fileInput);"]},{"start":{"row":22,"column":4},"end":{"row":26,"column":34},"action":"insert","lines":["var form         = $(fileInput.parents('form:first'));","    var submitButton = form.find('input[type=\"submit\"]');","    var progressBar  = $(\"<div class='bar'></div>\");","    var barContainer = $(\"<div class='progress'></div>\").append(progressBar);","    fileInput.after(barContainer);"]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":34},"end":{"row":27,"column":0},"action":"insert","lines":["",""]},{"start":{"row":27,"column":0},"end":{"row":27,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":27,"column":4},"end":{"row":36,"column":7},"action":"insert","lines":["fileInput.fileupload({","      fileInput:       fileInput,","      url:             '<%= @s3_direct_post.url %>',","      type:            'POST',","      autoUpload:       true,","      formData:         <%= @s3_direct_post.fields.to_json.html_safe %>,","      paramName:        'file', // S3 does not like nested name fields i.e. name=\"user[avatar_url]\"","      dataType:         'XML',  // S3 returns XML if success_action_status is set to 201","      replaceFileInput: false","    });"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":0},"end":{"row":38,"column":3},"action":"remove","lines":["$(function() {","  $('.directUpload').find(\"input:file\").each(function(i, elem) {","    var fileInput    = $(elem);","    var form         = $(fileInput.parents('form:first'));","    var submitButton = form.find('input[type=\"submit\"]');","    var progressBar  = $(\"<div class='bar'></div>\");","    var barContainer = $(\"<div class='progress'></div>\").append(progressBar);","    fileInput.after(barContainer);","    fileInput.fileupload({","      fileInput:       fileInput,","      url:             '<%= @s3_direct_post.url %>',","      type:            'POST',","      autoUpload:       true,","      formData:         <%= @s3_direct_post.fields.to_json.html_safe %>,","      paramName:        'file', // S3 does not like nested name fields i.e. name=\"user[avatar_url]\"","      dataType:         'XML',  // S3 returns XML if success_action_status is set to 201","      replaceFileInput: false","    });","  });","});"]},{"start":{"row":19,"column":0},"end":{"row":70,"column":3},"action":"insert","lines":["$(function() {","  $('.directUpload').find(\"input:file\").each(function(i, elem) {","    var fileInput    = $(elem);","    var form         = $(fileInput.parents('form:first'));","    var submitButton = form.find('input[type=\"submit\"]');","    var progressBar  = $(\"<div class='bar'></div>\");","    var barContainer = $(\"<div class='progress'></div>\").append(progressBar);","    fileInput.after(barContainer);","    fileInput.fileupload({","      fileInput:       fileInput,","      url:             '<%= @s3_direct_post.url %>',","      type:            'POST',","      autoUpload:       true,","      formData:         <%= @s3_direct_post.fields.to_json.html_safe %>,","      paramName:        'file', // S3 does not like nested name fields i.e. name=\"user[avatar_url]\"","      dataType:         'XML',  // S3 returns XML if success_action_status is set to 201","      replaceFileInput: false,","      progressall: function (e, data) {","        var progress = parseInt(data.loaded / data.total * 100, 10);","        progressBar.css('width', progress + '%')","      },","      start: function (e) {","        submitButton.prop('disabled', true);","","        progressBar.","          css('background', 'green').","          css('display', 'block').","          css('width', '0%').","          text(\"Loading...\");","      },","      done: function(e, data) {","        submitButton.prop('disabled', false);","        progressBar.text(\"Uploading done\");","","        // extract key and generate URL from response","        var key   = $(data.jqXHR.responseXML).find(\"Key\").text();","        var url   = '//<%= @s3_direct_post.url.host %>/' + key;","","        // create hidden field","        var input = $(\"<input />\", { type:'hidden', name: fileInput.attr('name'), value: url })","        form.append(input);","      },","      fail: function(e, data) {","        submitButton.prop('disabled', false);","","        progressBar.","          css(\"background\", \"red\").","          text(\"Failed\");","      }","    });","  });","});"]}]}],[{"group":"doc","deltas":[{"start":{"row":27,"column":2},"end":{"row":69,"column":2},"action":"remove","lines":["  fileInput.fileupload({","      fileInput:       fileInput,","      url:             '<%= @s3_direct_post.url %>',","      type:            'POST',","      autoUpload:       true,","      formData:         <%= @s3_direct_post.fields.to_json.html_safe %>,","      paramName:        'file', // S3 does not like nested name fields i.e. name=\"user[avatar_url]\"","      dataType:         'XML',  // S3 returns XML if success_action_status is set to 201","      replaceFileInput: false,","      progressall: function (e, data) {","        var progress = parseInt(data.loaded / data.total * 100, 10);","        progressBar.css('width', progress + '%')","      },","      start: function (e) {","        submitButton.prop('disabled', true);","","        progressBar.","          css('background', 'green').","          css('display', 'block').","          css('width', '0%').","          text(\"Loading...\");","      },","      done: function(e, data) {","        submitButton.prop('disabled', false);","        progressBar.text(\"Uploading done\");","","        // extract key and generate URL from response","        var key   = $(data.jqXHR.responseXML).find(\"Key\").text();","        var url   = '//<%= @s3_direct_post.url.host %>/' + key;","","        // create hidden field","        var input = $(\"<input />\", { type:'hidden', name: fileInput.attr('name'), value: url })","        form.append(input);","      },","      fail: function(e, data) {","        submitButton.prop('disabled', false);","","        progressBar.","          css(\"background\", \"red\").","          text(\"Failed\");","      }","    });","  "]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":0},"end":{"row":28,"column":3},"action":"remove","lines":["//= require z.jquery.fileupload","","$(function() {","  $('.directUpload').find(\"input:file\").each(function(i, elem) {","    var fileInput    = $(elem);","    var form         = $(fileInput.parents('form:first'));","    var submitButton = form.find('input[type=\"submit\"]');","    var progressBar  = $(\"<div class='bar'></div>\");","    var barContainer = $(\"<div class='progress'></div>\").append(progressBar);","    fileInput.after(barContainer);","  });","});"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":0},"end":{"row":17,"column":31},"action":"insert","lines":["//= require z.jquery.fileupload"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":0},"end":{"row":17,"column":31},"action":"remove","lines":["//= require z.jquery.fileupload"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":18},"end":{"row":17,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":0},"end":{"row":16,"column":18},"action":"remove","lines":["//= require_tree ."]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":22},"end":{"row":16,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":22},"end":{"row":16,"column":0},"action":"insert","lines":["",""]}]}]]},"ace":{"folds":[],"scrolltop":75,"scrollleft":0,"selection":{"start":{"row":16,"column":0},"end":{"row":16,"column":18},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1421435069133,"hash":"a938b11f723f61821dddfad562530762d56c1123"}